{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./sources/ext/multiselect.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","gantt","config","multiselect","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","selected","this","getSelected","length","setFirstSelected","id","getFirstSelected","isActive","updateState","active","reset","setLastSelected","$data","tasksStore","silent","store","select","unselect","getLastSelected","last","getSelectedId","isTaskExists","e","callEvent","afterSelect","toggle","isSelected","res","push","sort","a","b","getGlobalTaskIndex","forSelected","callback","isSameLevel","calculateTaskLevel","getTask","refreshTask","doSelection","_is_icon_open_click","target_ev","locate","defaultLast","isLast","shiftKey","ctrlKey","metaKey","first_indx","target_indx","last_indx","tmp","getNext","getPrev","old_selectTask","selectTask","old_unselectTask","unselectTask","toggleTaskSelection","getSelectedTasks","eachSelectedTask","isSelectedTask","getLastSelectedTask","attachEvent","new_id","item","task_id","state"],"mappings":"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","file":"ext/dhtmlxgantt_multiselect.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/codebase/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 184);\n","gantt.config.multiselect = true;\r\ngantt.config.multiselect_one_level = false;\r\n\r\ngantt._multiselect = {\r\n\t_selected: {},\r\n\t_one_level: false,\r\n\t_active: true,\r\n\t_first_selected_when_shift: null,\r\n\tgetDefaultSelected: function() {\r\n\t\tvar selected = this.getSelected();\r\n\t\treturn selected.length ? selected[selected.length - 1] : null;\r\n\t},\r\n\tsetFirstSelected: function(id) {\r\n\t\tthis._first_selected_when_shift = id;\r\n\t},\r\n\tgetFirstSelected: function() {\r\n\t\treturn this._first_selected_when_shift;\r\n\t},\r\n\tisActive: function() {\r\n\t\tthis.updateState();\r\n\t\treturn this._active;\r\n\t},\r\n\tupdateState: function() {\r\n\t\tthis._one_level = gantt.config.multiselect_one_level;\r\n\t\tvar active = this._active;\r\n\t\tthis._active = gantt.config.multiselect;\r\n\t\tif (this._active != active) {\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\t},\r\n\treset: function () {\r\n\t\tthis._selected = {};\r\n\t},\r\n\tsetLastSelected: function (id) {\r\n\t\tgantt.$data.tasksStore.silent(function(){\r\n\t\t\tvar store = gantt.$data.tasksStore;\r\n\t\t\tif (id) \r\n\t\t\t\tstore.select(id+\"\"); \r\n\t\t\telse \r\n\t\t\t\tstore.unselect(null);\r\n\t\t});\r\n\t},\r\n\tgetLastSelected: function () {\r\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\r\n\t\tif (last && gantt.isTaskExists(last))\r\n\t\t\treturn last;\r\n\t\treturn null;\r\n\t},\r\n\tselect: function (id, e) {\r\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\r\n\t\t\tthis._selected[id] = true;\r\n\t\t\tthis.setLastSelected(id);\r\n\t\t\tthis.afterSelect(id);\r\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\r\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\ttoggle: function (id, e) {\r\n\t\tif (this._selected[id]) {\r\n\t\t\tthis.unselect(id, e);\r\n\t\t} else {\r\n\t\t\tthis.select(id, e);\r\n\t\t}\r\n\t},\r\n\tunselect: function (id, e) {\r\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\r\n\t\t\tthis._selected[id] = false;\r\n\t\t\tif (this.getLastSelected() == id)\r\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\r\n\t\t\tthis.afterSelect(id);\r\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\r\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\r\n\t\t}\r\n\t},\r\n\tisSelected: function (id) {\r\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\r\n\t},\r\n\tgetSelected: function () {\r\n\t\tvar res = [];\r\n\t\tfor (var i in this._selected) {\r\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\r\n\t\t\t\tres.push(i);\r\n\t\t\t} else {\r\n\t\t\t\tthis._selected[i] = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tres.sort(function(a, b) {\r\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\r\n\t\t});\t\t\r\n\t\treturn res;\r\n\t},\r\n\tforSelected: function (callback) {\r\n\t\tvar selected = this.getSelected();\r\n\t\tfor (var i = 0; i < selected.length; i++) {\r\n\t\t\tcallback(selected[i]);\r\n\t\t}\r\n\t},\r\n\tisSameLevel: function(id) {\r\n\t\tif (!this._one_level)\r\n\t\t\treturn true;\r\n\t\tvar last = this.getLastSelected();\r\n\t\tif (!last)\r\n\t\t\treturn true;\r\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\r\n\t\t\treturn true;\r\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\r\n\t},\r\n\tafterSelect: function(id) {\r\n\t\tif (gantt.isTaskExists(id))\r\n\t\t\tgantt.refreshTask(id);\r\n\t},\r\n\tdoSelection: function(e) {\r\n\t\t\r\n\t\tif (!this.isActive())\r\n\t\t\treturn false;\r\n\r\n\t\t// deny selection when click on 'expand' or 'collapse' icons\r\n\t\tif (gantt._is_icon_open_click(e))\r\n\t\t\treturn false;\r\n\r\n\t\tvar target_ev = gantt.locate(e);\r\n\t\tif (!target_ev)\r\n\t\t\treturn false;\r\n\r\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\r\n\t\t\treturn false;\r\n\r\n\t\tvar selected = this.getSelected();\r\n\t\tvar defaultLast = this.getFirstSelected();\r\n\t\tvar isLast = false;\r\n\t\tvar last = this.getLastSelected();\r\n\r\n\t\tif (e.shiftKey) {\r\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\r\n\t\t\t\tthis.setFirstSelected(target_ev);\r\n\t\t\t}\r\n\t\t} else if (e.ctrlKey || e.metaKey) {\r\n\t\t\tif (!this.isSelected(target_ev))\r\n\t\t\t\tthis.setFirstSelected(target_ev);\r\n\t\t} else {\r\n\t\t\tthis.setFirstSelected(target_ev);\r\n\t\t}\r\n\t\t\r\n\t\tif (e.ctrlKey || e.metaKey) {\r\n\t\t\tif (target_ev) {\r\n\t\t\t\tthis.toggle(target_ev, e);\r\n\t\t\t}\r\n\t\t} else if (e.shiftKey && selected.length) {\r\n\t\t\tif (!last)\r\n\t\t\t\tlast = target_ev;\r\n\t\t\telse if (target_ev) {\r\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\r\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\r\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\r\n\t\t\t\t\r\n\t\t\t\t// clear prev selection\r\n\t\t\t\tvar tmp = last;\r\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\r\n\t\t\t\t\tthis.unselect(tmp, e);\r\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\r\n\t\t\t\t}\r\n\t\t\t\ttmp = target_ev;\r\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\r\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\r\n\t\t\t\t\t\tisLast = true;\r\n\t\t\t\t\t\tdefaultLast = tmp;\r\n\t\t\t\t\t} \r\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else { // no key press when mouse click\r\n\t\t\tif (!this.isSelected(target_ev)) {\r\n\t\t\t\tthis.select(target_ev, e);\r\n\t\t\t}\r\n\t\t\tselected = this.getSelected();\r\n\t\t\tfor (var i=0; i<selected.length; i++) {\r\n\t\t\t\tif (selected[i] !== target_ev) {\r\n\t\t\t\t\tthis.unselect(selected[i], e);\r\n\t\t\t\t}\t\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isSelected(target_ev)) {\r\n\t\t\tthis.setLastSelected(target_ev);\r\n\t\t} else if (defaultLast) {\r\n\t\t\tif (target_ev == last)\r\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\r\n\t\t} else {\r\n\t\t\tthis.setLastSelected(null);\r\n\t\t}\r\n\r\n\t\tif (!this.getSelected().length)\r\n\t\t\tthis.setLastSelected(null);\r\n\r\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\r\n\t\t\tthis.setFirstSelected(this.getLastSelected());\r\n\r\n\t\treturn true;\r\n\t}\r\n};\r\n\r\n(function(){\r\n\t\r\n\tvar old_selectTask = gantt.selectTask;\r\n\tgantt.selectTask = function(id) {\r\n\t\tif (!id)\r\n\t\t\treturn false;\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tvar res = id;\r\n\t\tif (multiselect.isActive()) {\r\n\t\t\tif (multiselect.select(id, null)) {\r\n\t\t\t\tmultiselect.setLastSelected(id);\r\n\t\t\t}\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t} else {\r\n\t\t\tres = old_selectTask.call(this, id);\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\tvar old_unselectTask = gantt.unselectTask;\r\n\tgantt.unselectTask = function(id) {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tvar isActive = multiselect.isActive();\r\n\t\tid = id || multiselect.getLastSelected();\r\n\t\tif(id && isActive) {\r\n\t\t\tmultiselect.unselect(id, null);\r\n\t\t\tif (id == multiselect.getLastSelected())\r\n\t\t\t\tmultiselect.setLastSelected(null);\r\n\t\t\tgantt.refreshTask(id);\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t}\r\n\t\tvar res = id;\r\n\t\tif (!isActive)\r\n\t\t\tres = old_unselectTask.call(this, id);\r\n\t\treturn res;\r\n\t};\r\n\r\n\tgantt.toggleTaskSelection = function(id) {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tif (id && multiselect.isActive()) {\r\n\t\t\tmultiselect.toggle(id);\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t}\r\n\t};\r\n\tgantt.getSelectedTasks = function() {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tmultiselect.isActive();\r\n\t\treturn multiselect.getSelected();\r\n\t};\r\n\tgantt.eachSelectedTask = function(callback){\r\n\t\treturn this._multiselect.forSelected(callback);\r\n\t};\r\n\tgantt.isSelectedTask = function(id){\r\n\t\treturn this._multiselect.isSelected(id);\r\n\t};\r\n\tgantt.getLastSelectedTask = function(){\r\n\t\treturn this._multiselect.getLastSelected();\r\n\t};\r\n\r\n})();\r\n\r\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\r\n\tvar multiselect = gantt._multiselect;\r\n\tif (!multiselect.isActive())\r\n\t\treturn true;\r\n\tif (gantt.isSelectedTask(id)) {\r\n\t\tmultiselect.unselect(id, null);\r\n\t\tmultiselect.select(new_id, null);\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\r\n\tvar multiselect = gantt._multiselect;\r\n\tif (!multiselect.isActive())\r\n\t\treturn true;\r\n\r\n\tif (multiselect._selected[id]) {\r\n\t\tmultiselect.unselect(id, null);\r\n\t\tmultiselect._selected[id] = false;\r\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\r\n\t}\r\n\r\n\tmultiselect.forSelected(function (task_id) {\r\n\t\tif (!gantt.isTaskExists(task_id))\r\n\t\t\tmultiselect.unselect(task_id, null);\r\n\t});\r\n});\r\n\r\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\r\n\tvar multiselect = gantt._multiselect;\r\n\tif (state && multiselect.isActive()) {\r\n\t\tif (multiselect._one_level) {\r\n\t\t\treturn multiselect.isSameLevel(id);\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n});\r\n\r\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\r\n\tif (gantt._multiselect.doSelection(e))\r\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\r\n\treturn true;\r\n});"],"sourceRoot":""}