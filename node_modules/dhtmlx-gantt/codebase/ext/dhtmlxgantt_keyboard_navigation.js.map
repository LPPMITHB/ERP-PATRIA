{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./sources/utils/dom_helpers.js","webpack:///./sources/ext/keyboard_navigation/core.js","webpack:///./sources/ext/keyboard_navigation/modals.js","webpack:///./sources/ext/keyboard_navigation/elements/task_cell.js","webpack:///./sources/ext/keyboard_navigation/elements/task_row.js","webpack:///./sources/ext/keyboard_navigation/elements/header_cell.js","webpack:///./sources/ext/keyboard_navigation/elements/nav_node.js","webpack:///./sources/ext/keyboard_navigation/elements/gantt_node.js","webpack:///./sources/ext/keyboard_navigation/common/trap_modal_focus.js","webpack:///./sources/ext/keyboard_navigation/common/eventhandler.js","webpack:///./sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","webpack:///./sources/ext/keyboard_navigation.js","webpack:///./sources/utils/eventable.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","elementPosition","elem","top","left","right","bottom","getBoundingClientRect","box","body","document","docElem","documentElement","parentNode","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","offsetWidth","offsetHeight","parseInt","offsetTop","offsetLeft","offsetParent","y","Math","round","x","width","height","isVisible","node","display","visibility","getComputedStyle","style","currentStyle","hasNonNegativeTabIndex","isNaN","getAttribute","hasHref","a","area","nodeName","loLowerCase","isEnabled","input","select","textarea","button","toLowerCase","hasAttribute","getClassName","className","baseVal","indexOf","_trimString","_slave","createElement","getTargetNode","e","tagName","event","target","srcElement","str","String","trim","this","replace","apply","getNodePosition","getFocusableNodes","root","nodes","querySelectorAll","join","nodesArray","Array","slice","length","splice","getScrollSize","div","cssText","appendChild","clientWidth","removeChild","addClassName","removeClassName","split","regEx","RegExp","insertNode","newone","innerHTML","child","firstChild","removeNode","getChildNodes","css","ch","childNodes","len","out","obj","push","toNode","getElementById","querySelector","locateClassName","classname","strict","undefined","trg","ind","charAt","locateAttribute","attribute","getRelativeEventPosition","ev","pageX","pageY","pos","clientX","clientY","isChildOf","parent","gantt","$keyboardNavigation","dispatcher","isActive","activeNode","globalNode","GanttNode","enable","setActiveNode","getActiveNode","disable","getDefaultNode","config","keyboard_navigation_cells","TaskCell","TaskRow","isValid","fallback","setDefaultNode","fromDomElement","inputs","HeaderCell","focusGlobalNode","blurNode","focusNode","el","focusChanged","compareTo","keptFocus","focus","blur","keyDownHandler","isModal","defaultPrevented","ganttNode","command","shortcuts","getCommandFromEvent","activeElement","facade","callEvent","findHandler","doAction","_timeout","awaitsFocus","delay","callback","clearTimeout","setTimeout","clearDelay","modalsStack","afterPopup","startModal","eventRemove","trapFocus","endModal","pop","currentTarget","isTopModal","traceLightbox","getLightbox","attachEvent","focusElement","domHelpers","taskId","index","rootLevel","getChildren","root_id","columnIndex","getTaskIndex","_compose","_handlers","getGridColumns","visibleColumns","locate","isTaskExists","cellElement","getNode","isTaskVisible","show_grid","row","$grid","task_attribute","getTaskNode","keys","up","nextElement","prevTask","getPrev","moveTo","down","nextTask","getNext","columns","end","home","pagedown","getVisibleTaskCount","getTaskByIndex","id","pageup","bindAll","KeyNavNode","header","nextIndex","viewWidth","viewHeight","getTaskPosition","getTask","row_height","scroll","getScrollState","$task","inner_width","$grid_data","$task_data","inner_height","scrollTo","show_chart","task_scroll_offset","shift+down","hasChild","$open","open","shift+up","close","shift+right","prevId","getPrevSibling","moveTask","updateTask","shift+left","getParent","space","getState","selected_task","selectTask","unselectTask","ctrl+left","ctrl+right","delete","$click","buttons","enter","showLightbox","ctrl+enter","createTask","previousSibling","$grid_scale","taskRow","enter, space","click","EventHandler","element","b","canStringifyThis","toString","canStringifyThat","eventFacade","setAttribute","$eventAttached","preventDefault","$container","removeAttribute","scrollHorizontal","dir","date","dateFromPos","step","add","scale_unit","posFromDate","scrollVertical","alt+left","alt+right","alt+up","alt+down","ctrl+z","undo","ctrl+r","redo","keyCode","focusable","currentFocus","currentIndex","shiftKey","lastItem","firstItem","hash","getHash","handler","returnValue","shortcut","commands","parse","unbind","map","initKeys","createCommand","modifiers","shift","alt","ctrl","meta","expr","getExpressions","words","getWords","j","commandKeys","specialKeys","charCodeAt","domEvent","altKey","ctrlKey","metaKey","which","printableKey","fromCharCode","getHashFromEvent","parts","junctionChar","term","combinationChar","backspace","tab","esc","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","eventable","keyboard_navigation","arguments","res","isTaskFocused","focusHandler","$preventDefault","reFocusActiveNode","domElement","mousedownHandler","locateTask","onReady","detachEvent","$data","tasksStore","currentNode","_smart_render","updateRender","_redrawItems","renderers","items","focusedItemVisible","start_date","item","nodeConstructor","oldId","newId","interval","setInterval","getSelection","_locate_css","getScope","scopes","headerCell","taskCell","clearInterval","keyNavFacade","mixin","addShortcut","scope","scopeObject","getShortcutHandler","removeShortcut","type","constructor","getColumnIndex","column","ext","keyboardNavigation","setupKeyNav","EventHost","_connected","_silent_mode","_silentStart","_silentEnd","createEventStorage","dhx_catch","z","zr","addEvent","removeEvent","eventHost","catcher","callObj","attachAll","arg0","handlerName","concat","checkEvent","list","detachAllEvents"],"mappings":"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","file":"ext/dhtmlxgantt_keyboard_navigation.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/codebase/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 196);\n","//returns position of html element on the page\r\nfunction elementPosition(elem) {\r\n\tvar top=0, left=0, right=0, bottom=0;\r\n\tif (elem.getBoundingClientRect) { //HTML5 method\r\n\t\tvar box = elem.getBoundingClientRect();\r\n\t\tvar body = document.body;\r\n\t\tvar docElem = (document.documentElement ||\r\n\t\t\tdocument.body.parentNode ||\r\n\t\t\tdocument.body);\r\n\r\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\r\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\t\ttop  = box.top +  scrollTop - clientTop;\r\n\t\tleft = box.left + scrollLeft - clientLeft;\r\n\r\n\t\tright = document.body.offsetWidth - box.right;\r\n\t\tbottom = document.body.offsetHeight - box.bottom;\r\n\t} else { //fallback to naive approach\r\n\t\twhile(elem) {\r\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\r\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\r\n\t\t\telem = elem.offsetParent;\r\n\t\t}\r\n\r\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\r\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\r\n\t}\r\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\r\n}\r\n\r\nfunction isVisible(node){\r\n\tvar display = false,\r\n\t\tvisibility = false;\r\n\tif(window.getComputedStyle){\r\n\t\tvar style = window.getComputedStyle(node, null);\r\n\t\tdisplay = style[\"display\"];\r\n\t\tvisibility = style[\"visibility\"];\r\n\t}else if(node.currentStyle){\r\n\t\tdisplay = node.currentStyle[\"display\"];\r\n\t\tvisibility = node.currentStyle[\"visibility\"];\r\n\t}\r\n\treturn (display != \"none\" && visibility != \"hidden\");\r\n}\r\n\r\nfunction hasNonNegativeTabIndex(node){\r\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\r\n}\r\n\r\nfunction hasHref(node){\r\n\tvar canHaveHref = {\"a\": true, \"area\": true};\r\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\r\n\t\treturn !!node.getAttribute(\"href\");\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction isEnabled(node){\r\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\r\n\tif(canDisable[node.nodeName.toLowerCase()]){\r\n\t\treturn !node.hasAttribute(\"disabled\");\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction getFocusableNodes(root){\r\n\tvar nodes = root.querySelectorAll([\r\n\t\t\"a[href]\",\r\n\t\t\"area[href]\",\r\n\t\t\"input\",\r\n\t\t\"select\",\r\n\t\t\"textarea\",\r\n\t\t\"button\",\r\n\t\t\"iframe\",\r\n\t\t\"object\",\r\n\t\t\"embed\",\r\n\t\t\"[tabindex]\",\r\n\t\t\"[contenteditable]\"\r\n\t].join(\", \"));\r\n\r\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\r\n\tfor(var i = 0; i < nodesArray.length; i++){\r\n\t\tvar node = nodesArray[i];\r\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\r\n\t\tif(!isValid){\r\n\t\t\tnodesArray.splice(i, 1);\r\n\t\t\ti--;\r\n\t\t}\r\n\t}\r\n\treturn nodesArray;\r\n}\r\n\r\nfunction getScrollSize(){\r\n\tvar div = document.createElement(\"div\");\r\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\r\n\r\n\tdocument.body.appendChild(div);\r\n\tvar width = div.offsetWidth-div.clientWidth;\r\n\tdocument.body.removeChild(div);\r\n\r\n\treturn width;\r\n}\r\n\r\nfunction getClassName(node){\r\n\tif(!node) return \"\";\r\n\r\n\tvar className = node.className || \"\";\r\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\r\n\t\tclassName = className.baseVal;\r\n\r\n\tif(!className.indexOf)\r\n\t\tclassName = '';\r\n\r\n\treturn _trimString(className);\r\n}\r\n\r\nfunction addClassName(node, className){\r\n\tif (className && node.className.indexOf(className) === -1) {\r\n\t\tnode.className += \" \" + className;\r\n\t}\r\n}\r\n\r\nfunction removeClassName(node, name) {\r\n\tname = name.split(\" \");\r\n\tfor (var i = 0; i < name.length; i++) {\r\n\t\tvar regEx = new RegExp('\\\\s?\\\\b' + name[i] + '\\\\b(?![-_\\.])', \"\");\r\n\t\tnode.className = node.className.replace(regEx, \"\");\r\n\t}\r\n}\r\n\r\nfunction toNode(node) {\r\n\tif (typeof node === \"string\") {\r\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\r\n\t}\r\n\treturn node || document.body;\r\n}\r\n\r\nvar _slave = document.createElement(\"div\");\r\nfunction insert(node, newone) {\r\n\t_slave.innerHTML = newone;\r\n\tvar child = _slave.firstChild;\r\n\tnode.appendChild(child);\r\n\treturn child;\r\n}\r\n\r\nfunction remove(node) {\r\n\tif (node && node.parentNode) {\r\n\t\tnode.parentNode.removeChild(node);\r\n\t}\r\n}\r\n\r\nfunction getChildren(node, css) {\r\n\tvar ch = node.childNodes;\r\n\tvar len = ch.length;\r\n\tvar out = [];\r\n\tfor (var i = 0; i < len; i++) {\r\n\t\tvar obj = ch[i];\r\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\r\n\t\t\tout.push(obj);\r\n\t\t}\r\n\t}\r\n\treturn out;\r\n}\r\n\r\nfunction getTargetNode(e){\r\n\tvar trg;\r\n\tif (e.tagName)\r\n\t\ttrg = e;\r\n\telse {\r\n\t\te=e||window.event;\r\n\t\ttrg=e.target||e.srcElement;\r\n\t}\r\n\treturn trg;\r\n}\r\n\r\nfunction locateAttribute(e, attribute) {\r\n\tif(!attribute) return;\r\n\r\n\tvar trg = getTargetNode(e);\r\n\r\n\twhile (trg){\r\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\r\n\t\t\tvar test = trg.getAttribute(attribute);\r\n\t\t\tif (test) return trg;\r\n\t\t}\r\n\t\ttrg=trg.parentNode;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction _trimString(str){\r\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\r\n\treturn func.apply(str);\r\n}\r\n\r\nfunction locateClassName(e, classname, strict){\r\n\tif(strict === undefined)\r\n\t\tstrict = true;\r\n\r\n\tvar trg = getTargetNode(e);\r\n\tvar css = '';\r\n\tvar test = false;\r\n\twhile (trg){\r\n\t\tcss = getClassName(trg);\r\n\r\n\t\tif(css){\r\n\t\t\tvar ind = css.indexOf(classname);\r\n\t\t\tif (ind >= 0){\r\n\t\t\t\tif (!strict)\r\n\t\t\t\t\treturn trg;\r\n\r\n\t\t\t\t//check that we have exact match\r\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\r\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\r\n\r\n\t\t\t\tif (left && right)\r\n\t\t\t\t\treturn trg;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttrg=trg.parentNode;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n/*\r\nevent position relatively to DOM element\r\n */\r\nfunction getRelativeEventPosition(ev, node){\r\n\tif (ev.pageX || ev.pageY)\r\n\t\tvar pos = {x: ev.pageX, y: ev.pageY};\r\n\r\n\tvar d = document.documentElement;\r\n\tvar pos = {\r\n\t\tx: ev.clientX + d.scrollLeft - d.clientLeft,\r\n\t\ty: ev.clientY + d.scrollTop - d.clientTop\r\n\t};\r\n\r\n\tvar box = elementPosition(node);\r\n\tpos.x = pos.x - box.x + node.scrollLeft;\r\n\tpos.y = pos.y - box.y + node.scrollTop;\r\n\treturn pos;\r\n}\r\n\r\n\r\nfunction isChildOf(child, parent){\r\n\tif(!child || !parent){\r\n\t\treturn false;\r\n\t}\r\n\r\n\twhile(child && child != parent) {\r\n\t\tchild = child.parentNode;\r\n\t}\r\n\r\n\treturn child === parent;\r\n}\r\n\r\nmodule.exports = {\r\n\tgetNodePosition: elementPosition,\r\n\tgetFocusableNodes: getFocusableNodes,\r\n\tgetScrollSize: getScrollSize,\r\n\tgetClassName: getClassName,\r\n\taddClassName: addClassName,\r\n\tremoveClassName: removeClassName,\r\n\tinsertNode: insert,\r\n\tremoveNode: remove,\r\n\tgetChildNodes: getChildren,\r\n\ttoNode: toNode,\r\n\tlocateClassName:locateClassName,\r\n\tlocateAttribute: locateAttribute,\r\n\tgetTargetNode: getTargetNode,\r\n\tgetRelativeEventPosition: getRelativeEventPosition,\r\n\tisChildOf: isChildOf,\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.dispatcher = {\r\n\t\tisActive: false,\r\n\t\tactiveNode: null,\r\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\r\n\r\n\t\tenable: function () {\r\n\t\t\tthis.isActive = true;\r\n\t\t\tthis.globalNode.enable();\r\n\t\t\tthis.setActiveNode(this.getActiveNode());\r\n\t\t},\r\n\r\n\t\tdisable: function () {\r\n\t\t\tthis.isActive = false;\r\n\t\t\tthis.globalNode.disable();\r\n\t\t},\r\n\r\n\t\tisEnabled: function () {\r\n\t\t\treturn !!this.isActive;\r\n\t\t},\r\n\r\n\t\tgetDefaultNode: function () {\r\n\t\t\tvar node;\r\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\r\n\t\t\t} else {\r\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\r\n\t\t\t}\r\n\r\n\t\t\tif (!node.isValid()) {\r\n\t\t\t\tnode = node.fallback();\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\tsetDefaultNode: function () {\r\n\t\t\tthis.setActiveNode(this.getDefaultNode());\r\n\t\t},\r\n\r\n\t\tgetActiveNode: function () {\r\n\t\t\tvar node = this.activeNode;\r\n\t\t\tif (node && !node.isValid()) {\r\n\t\t\t\tnode = node.fallback();\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\tfromDomElement: function(e){\r\n\t\t\tvar inputs = [\r\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\r\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\r\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\r\n\t\t\t];\r\n\t\t\tfor(var i = 0; i < inputs.length; i++){\r\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\r\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\r\n\t\t\t\t\tif(node) return node;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tfocusGlobalNode: function () {\r\n\t\t\tthis.blurNode(this.globalNode);\r\n\t\t\tthis.focusNode(this.globalNode);\r\n\t\t},\r\n\r\n\t\tsetActiveNode: function (el) {\r\n\t\t\t//console.trace()\r\n\t\t\tvar focusChanged = true;\r\n\t\t\tif (this.activeNode) {\r\n\t\t\t\tif (this.activeNode.compareTo(el)) {\r\n\t\t\t\t\tfocusChanged = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.isEnabled()) {\r\n\t\t\t\tif(focusChanged)\r\n\t\t\t\t\tthis.blurNode(this.activeNode);\r\n\r\n\t\t\t\tthis.activeNode = el;\r\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfocusNode: function (el, keptFocus) {\r\n\t\t\tif (el && el.focus) {\r\n\t\t\t\tel.focus(keptFocus);\r\n\t\t\t}\r\n\t\t},\r\n\t\tblurNode: function (el) {\r\n\t\t\tif (el && el.blur) {\r\n\t\t\t\tel.blur();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tkeyDownHandler: function (e) {\r\n\r\n\t\t\tif (gantt.$keyboardNavigation.isModal())\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (!this.isEnabled())\r\n\t\t\t\treturn;\r\n\r\n\t\t\te = e || window.event;\r\n\r\n\r\n\t\t\tif(e.defaultPrevented){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar ganttNode = this.globalNode;\r\n\r\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\r\n\r\n\t\t\tvar activeElement = this.getActiveNode();\r\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!activeElement) {\r\n\t\t\t\tthis.setDefaultNode();\r\n\t\t\t} else if (activeElement.findHandler(command)) {\r\n\t\t\t\tactiveElement.doAction(command, e);\r\n\t\t\t} else if (ganttNode.findHandler(command)) {\r\n\t\t\t\tganttNode.doAction(command, e);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t_timeout: null,\r\n\t\tawaitsFocus: function(){\r\n\t\t\treturn this._timeout !== null;\r\n\t\t},\r\n\t\tdelay: function(callback, delay){\r\n\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\r\n\t\t\t\tthis._timeout = null;\r\n\t\t\t\tcallback();\r\n\t\t\t}, this)  , delay || 1);\r\n\r\n\t\t},\r\n\t\tclearDelay: function(){\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t}\r\n\t};\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\t(function () {\r\n\t\tvar modalsStack = [];\r\n\r\n\t\tfunction isModal() {\r\n\t\t\treturn !!modalsStack.length;\r\n\t\t}\r\n\r\n\t\tfunction afterPopup(box) {\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tif (!isModal())\r\n\t\t\t\t\tgantt.focus();\r\n\t\t\t}, 1);\r\n\t\t}\r\n\r\n\t\tfunction startModal(box) {\r\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\r\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\r\n\t\t\tmodalsStack.push(box);\r\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\r\n\t\t}\r\n\r\n\t\tfunction endModal() {\r\n\t\t\tvar box = modalsStack.pop();\r\n\t\t\tif (box) {\r\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\r\n\t\t\t}\r\n\t\t\tafterPopup(box);\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction isTopModal(box) {\r\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\r\n\t\t}\r\n\r\n\t\tfunction trapFocus(event) {\r\n\t\t\tvar event = event || window.event;\r\n\t\t\tvar target = event.currentTarget;\r\n\t\t\tif (!isTopModal(target)) return;\r\n\r\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\r\n\t\t}\r\n\r\n\t\tfunction traceLightbox() {\r\n\t\t\tstartModal(gantt.getLightbox());\r\n\t\t}\r\n\r\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\r\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\r\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\r\n\t\t\tendModal();\r\n\t\t\ttraceLightbox();\r\n\t\t});\r\n\r\n\r\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\r\n\t\t\tafterPopup();\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\r\n\t\t\tsaveFocus();\r\n\t\t\tstartModal(box);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\r\n\t\t\tendModal();\r\n\t\t\trestoreFocus();\r\n\t\t});\r\n\r\n\t\tvar focusElement = null;\r\n\r\n\t\tfunction saveFocus() {\r\n\t\t\tfocusElement = document.activeElement;\r\n\t\t}\r\n\r\n\t\tfunction restoreFocus() {\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tif (focusElement) {\r\n\t\t\t\t\tfocusElement.focus();\r\n\t\t\t\t\tfocusElement = null;\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t}\r\n\r\n\t\tgantt.$keyboardNavigation.isModal = isModal;\r\n\r\n\r\n\t})();\r\n\r\n};","module.exports = function(gantt) {\r\n\tvar domHelpers = require(\"../../../utils/dom_helpers\");\r\n\r\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\r\n\t\tif (!taskId) {\r\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\tif (rootLevel[0]) {\r\n\t\t\t\ttaskId = rootLevel[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.taskId = taskId;\r\n\t\tthis.columnIndex = index || 0;\r\n\t\tthis.index = gantt.getTaskIndex(this.taskId);\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.TaskRow,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\t\t\tisValid: function () {\r\n\r\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\r\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\r\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\r\n\t\t\t\t\tvar index = this.columnIndex;\r\n\t\t\t\t\twhile (index >= 0) {\r\n\t\t\t\t\t\tif (visibleColumns[index])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tindex--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (visibleColumns[index]) {\r\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar taskId = gantt.locate(el);\r\n\t\t\t\tif(gantt.isTaskExists(taskId)){\r\n\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\r\n\r\n\t\t\t\t\tif(cellElement){\r\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\r\n\t\t\t\t\tif (gantt.config.show_grid) {\r\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\r\n\t\t\t\t\t\tif(!row)\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\treturn row.childNodes[this.columnIndex];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"up\": function () {\r\n\r\n\t\t\t\t\tvar nextElement = null;\r\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\r\n\t\t\t\t\tif (!prevTask) {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.moveTo(nextElement);\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\r\n\t\t\t\t\tif (nextTask) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"left\": function () {\r\n\t\t\t\t\tif (this.columnIndex > 0) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"right\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"end\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\r\n\t\t\t\t},\r\n\t\t\t\t\"home\": function () {\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\r\n\t\t\t\t},\r\n\t\t\t\t\"pagedown\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"pageup\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\r\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\r\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\r\n\t\tif (!taskId) {\r\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\tif (rootLevel[0]) {\r\n\t\t\t\ttaskId = rootLevel[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.taskId = taskId;\r\n\t\tif (gantt.isTaskExists(this.taskId)) {\r\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.KeyNavNode,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\t\t\tisValid: function () {\r\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\r\n\t\t\t\t\tif (!header.isValid()) return null;\r\n\t\t\t\t\telse return header;\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar nextIndex = -1;\r\n\t\t\t\t\tif (gantt.getTaskByIndex(this.index - 1)) {\r\n\t\t\t\t\t\tnextIndex = this.index - 1;\r\n\t\t\t\t\t} else if (gantt.getTaskByIndex(this.index + 1)) {\r\n\t\t\t\t\t\tnextIndex = this.index + 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar index = this.index;\r\n\t\t\t\t\t\twhile (index >= 0) {\r\n\t\t\t\t\t\t\tif (gantt.getTaskByIndex(index) !== undefined) {\r\n\t\t\t\t\t\t\t\tnextIndex = index;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tindex--;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (nextIndex > -1) {\r\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar taskId = gantt.locate(el);\r\n\t\t\t\tif(gantt.isTaskExists(taskId)){\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\r\n\t\t\t\t\tif (gantt.config.show_grid) {\r\n\t\t\t\t\t\treturn gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfocus: function (keptFocus) {\r\n\t\t\t\tif(!keptFocus) {\r\n\t\t\t\t\tvar pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\r\n\t\t\t\t\tvar height = gantt.config.row_height;\r\n\t\t\t\t\tvar scroll = gantt.getScrollState();\r\n\r\n\t\t\t\t\tvar viewWidth;\r\n\t\t\t\t\tif(gantt.$task){\r\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar viewHeight;\r\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\r\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\r\n\r\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - height * 5);\r\n\r\n\t\t\t\t\t} else if (gantt.config.show_chart && (pos.left < scroll.x || pos.left > (scroll.x + viewWidth))) {\r\n\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"pagedown\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"pageup\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"up\": function () {\r\n\t\t\t\t\tvar nextElement = null;\r\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\r\n\t\t\t\t\tif (!prevTask) {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.moveTo(nextElement);\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\r\n\t\t\t\t\tif (nextTask) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"shift+down\": function(){\r\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\r\n\t\t\t\t\t\tgantt.open(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+up\": function(){\r\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\r\n\t\t\t\t\t\tgantt.close(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+right\": function(){\r\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\r\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\r\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\r\n\t\t\t\t\t\tparent.$open = true;\r\n\t\t\t\t\t\tgantt.moveTask(this.taskId, -1, prevId);\r\n\t\t\t\t\t\tgantt.updateTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+left\": function(){\r\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\r\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\r\n\t\t\t\t\t\tgantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\r\n\t\t\t\t\t\tgantt.updateTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// select\r\n\t\t\t\t\"space\": function (e) {\r\n\t\t\t\t\tif (gantt.getState().selected_task != this.taskId) {\r\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// collapse\r\n\t\t\t\t\"ctrl+left\": function (e) {\r\n\t\t\t\t\tgantt.close(this.taskId);\r\n\t\t\t\t},\r\n\t\t\t\t// expand\r\n\t\t\t\t\"ctrl+right\": function (e) {\r\n\t\t\t\t\tgantt.open(this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// delete task\r\n\t\t\t\t\"delete\": function (e) {\r\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// open lightbox\r\n\t\t\t\t\"enter\": function () {\r\n\t\t\t\t\tgantt.showLightbox(this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// add subtask\r\n\t\t\t\t\"ctrl+enter\": function () {\r\n\t\t\t\t\tgantt.createTask({}, this.taskId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\r\n\r\n};","module.exports = function(gantt) {\r\n\tvar domHelpers = require(\"../../../utils/dom_helpers\");\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\r\n\t\tthis.index = index || 0;\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.KeyNavNode,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\r\n\t\t\tisValid: function () {\r\n\t\t\t\tif (!gantt.config.show_grid) {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\tif (!gantt.config.show_grid) {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\r\n\t\t\t\tvar index = this.index;\r\n\t\t\t\twhile (index >= 0) {\r\n\t\t\t\t\tif (visibleColumns[index])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tindex--;\r\n\t\t\t\t}\r\n\t\t\t\tif (visibleColumns[index]) {\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\r\n\t\t\t\tif(cellElement){\r\n\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\r\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\r\n\t\t\t\t\t\tindex += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tvar cells = gantt.$grid_scale.childNodes;\r\n\t\t\t\treturn cells[this.index];\r\n\t\t\t},\r\n\r\n\r\n\t\t\tkeys: {\r\n\r\n\t\t\t\t\"left\": function () {\r\n\t\t\t\t\tif (this.index > 0) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"right\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tif (this.index < columns.length - 1) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar taskRow;\r\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\t\t\tif (rootLevel[0]) {\r\n\t\t\t\t\t\ttaskRow = rootLevel[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (taskRow) {\r\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"end\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\r\n\t\t\t\t},\r\n\t\t\t\t\"home\": function () {\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\r\n\t\t\t\t},\r\n\r\n\r\n\t\t\t\t// press header button\r\n\t\t\t\t\"enter, space\": function () {\r\n\t\t\t\t\tvar node = document.activeElement;\r\n\t\t\t\t\tnode.click();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// add new task\r\n\t\t\t\t\"ctrl+enter\": function () {\r\n\t\t\t\t\tgantt.createTask({}, this.taskId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.EventHandler,\r\n\t\t{\r\n\t\t\tisValid: function () {\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\r\n\t\t\tmoveTo: function (element) {\r\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\r\n\t\t\t},\r\n\r\n\t\t\tcompareTo: function (b) {\r\n\t\t\t\t// good enough comparison of two random objects\r\n\t\t\t\tif (!b) return false;\r\n\t\t\t\tfor (var i in this) {\r\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\r\n\r\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\r\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\r\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\r\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\r\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t},\r\n\t\t\tfocus: function () {\r\n\t\t\t\tvar node = this.getNode();\r\n\t\t\t\tif(!node)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\r\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t\tif(!node.$eventAttached){\r\n\t\t\t\t\t\tnode.$eventAttached = true;\r\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\r\n\t\t\t\t\t\t\te = e || event;\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//node.className += \" gantt_focused\";\r\n\t\t\t\t\tif (node.focus) node.focus();\r\n\r\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tblur: function () {\r\n\t\t\t\tvar node = this.getNode();\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\r\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.GanttNode = function () {\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.EventHandler,\r\n\t\t{\r\n\r\n\t\t\tfocus: function () {\r\n\t\t\t\tgantt.focus();\r\n\t\t\t},\r\n\r\n\t\t\tblur: function () {\r\n\r\n\t\t\t},\r\n\r\n\t\t\tdisable: function () {\r\n\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\r\n\t\t\t},\r\n\t\t\tenable: function () {\r\n\t\t\t\tif (gantt.$container)\r\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\r\n\t\t\t},\r\n\t\t\tisEnabled: function () {\r\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\r\n\t\t\t},\r\n\r\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\r\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\r\n\t\t\t\tvar step = dir < 0 ? -gantt.config.step : gantt.config.step;\r\n\t\t\t\tdate = gantt.date.add(date, step, gantt.config.scale_unit);\r\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\r\n\t\t\t},\r\n\r\n\t\t\tscrollVertical: function scrollVertical(dir) {\r\n\t\t\t\tvar top = gantt.getScrollState().y;\r\n\t\t\t\tvar step = gantt.config.row_height;\r\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"alt+left\": function (e) {\r\n\t\t\t\t\tthis.scrollHorizontal(-1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+right\": function (e) {\r\n\t\t\t\t\tthis.scrollHorizontal(1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+up\": function (e) {\r\n\t\t\t\t\tthis.scrollVertical(-1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+down\": function (e) {\r\n\t\t\t\t\tthis.scrollVertical(1);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// undo\r\n\t\t\t\t\"ctrl+z\": function () {\r\n\t\t\t\t\tif (gantt.undo) gantt.undo();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// redo\r\n\t\t\t\t\"ctrl+r\": function () {\r\n\t\t\t\t\tif (gantt.redo) gantt.redo();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\t(function () {\r\n\t\tvar domHelpers = require(\"../../../utils/dom_helpers\");\r\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\r\n\r\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\r\n\t\t\tif (e.keyCode != 9) return false;\r\n\r\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\r\n\t\t\tvar currentFocus = document.activeElement;\r\n\t\t\tvar currentIndex = -1;\r\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\r\n\t\t\t\tif (focusable[i] == currentFocus) {\r\n\t\t\t\t\tcurrentIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (e.shiftKey) {\r\n\t\t\t\t// back tab\r\n\t\t\t\tif (currentIndex <= 0) {\r\n\t\t\t\t\t// go to the last element if we focused on the first\r\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\r\n\t\t\t\t\tif (lastItem) {\r\n\t\t\t\t\t\tlastItem.focus();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// forward tab\r\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\r\n\t\t\t\t\t// forward tab from last element should go back to the first element\r\n\t\t\t\t\tvar firstItem = focusable[0];\r\n\t\t\t\t\tif (firstItem) {\r\n\t\t\t\t\t\tfirstItem.focus();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t};\r\n\t})();\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.EventHandler = {\r\n\t\t_handlers: null,\r\n\t\tfindHandler: function (command) {\r\n\t\t\tif (!this._handlers) this._handlers = {};\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\t\t\tvar hash = shortcuts.getHash(command);\r\n\r\n\t\t\treturn this._handlers[hash];\r\n\t\t},\r\n\r\n\t\tdoAction: function (command, e) {\r\n\t\t\tvar handler = this.findHandler(command);\r\n\t\t\tif (handler) {\r\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\r\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandler.call(this, e);\r\n\r\n\t\t\t\tif (e.preventDefault) e.preventDefault();\r\n\t\t\t\telse e.returnValue = false;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tbind: function (shortcut, handler) {\r\n\t\t\tif (!this._handlers) this._handlers = {};\r\n\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\r\n\t\t\tvar commands = shortcuts.parse(shortcut);\r\n\t\t\tfor (var i = 0; i < commands.length; i++) {\r\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\r\n\t\t\t}\r\n\t\t},\r\n\t\tunbind: function (shortcut) {\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\r\n\t\t\tvar commands = shortcuts.parse(shortcut);\r\n\t\t\tfor (var i = 0; i < commands.length; i++) {\r\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\r\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbindAll: function (map) {\r\n\t\t\tfor (var i in map) {\r\n\t\t\t\tthis.bind(i, map[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinitKeys: function () {\r\n\t\t\tif (!this._handlers)\r\n\t\t\t\tthis._handlers = {};\r\n\t\t\tif (this.keys) {\r\n\t\t\t\tthis.bindAll(this.keys);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n};","module.exports = function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.shortcuts = {\r\n\t\tcreateCommand: function () {\r\n\t\t\treturn {\r\n\t\t\t\tmodifiers: {\r\n\t\t\t\t\t\"shift\": false,\r\n\t\t\t\t\t\"alt\": false,\r\n\t\t\t\t\t\"ctrl\": false,\r\n\t\t\t\t\t\"meta\": false\r\n\t\t\t\t},\r\n\t\t\t\tkeyCode: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tparse: function (shortcut) {\r\n\t\t\tvar commands = [];\r\n\r\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\r\n\t\t\tfor (var i = 0; i < expr.length; i++) {\r\n\t\t\t\tvar words = this.getWords(expr[i]);\r\n\r\n\t\t\t\tvar command = this.createCommand();\r\n\r\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\r\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\r\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\r\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\r\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcommands.push(command);\r\n\t\t\t}\r\n\t\t\treturn commands;\r\n\t\t},\r\n\r\n\t\tgetCommandFromEvent: function (domEvent) {\r\n\t\t\tvar command = this.createCommand();\r\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\r\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\r\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\r\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\r\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\r\n\t\t\t\t// numpad keys 96-105 -> 48-57\r\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\r\n\t\t\t}\r\n\r\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\r\n\t\t\tif (printableKey) {\r\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\r\n\t\t\t}\r\n\t\t\treturn command;\r\n\t\t},\r\n\r\n\t\tgetHashFromEvent: function (domEvent) {\r\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\r\n\t\t},\r\n\r\n\t\tgetHash: function (command) {\r\n\t\t\tvar parts = [];\r\n\t\t\tfor (var i in command.modifiers) {\r\n\t\t\t\tif (command.modifiers[i]) {\r\n\t\t\t\t\tparts.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tparts.push(command.keyCode);\r\n\r\n\t\t\treturn parts.join(this.junctionChar);\r\n\t\t},\r\n\r\n\t\tgetExpressions: function (shortcut) {\r\n\t\t\treturn shortcut.split(this.junctionChar);\r\n\t\t},\r\n\t\tgetWords: function (term) {\r\n\t\t\treturn term.split(this.combinationChar);\r\n\t\t},\r\n\t\ttrim: function (shortcut) {\r\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\r\n\t\t},\r\n\t\tjunctionChar: \",\",\r\n\t\tcombinationChar: \"+\",\r\n\t\tcommandKeys: {\r\n\t\t\t\"shift\": 16,\r\n\t\t\t\"alt\": 18,\r\n\t\t\t\"ctrl\": 17,\r\n\t\t\t\"meta\": true\r\n\t\t},\r\n\t\tspecialKeys: {\r\n\t\t\t\"backspace\": 8,\r\n\t\t\t\"tab\": 9,\r\n\t\t\t\"enter\": 13,\r\n\t\t\t\"esc\": 27,\r\n\t\t\t\"space\": 32,\r\n\t\t\t\"up\": 38,\r\n\t\t\t\"down\": 40,\r\n\t\t\t\"left\": 37,\r\n\t\t\t\"right\": 39,\r\n\t\t\t\"home\": 36,\r\n\t\t\t\"end\": 35,\r\n\t\t\t\"pageup\": 33,\r\n\t\t\t\"pagedown\": 34,\r\n\t\t\t\"delete\": 46,\r\n\t\t\t\"insert\": 45,\r\n\t\t\t\"plus\": 107,\r\n\t\t\t\"f1\": 112,\r\n\t\t\t\"f2\": 113,\r\n\t\t\t\"f3\": 114,\r\n\t\t\t\"f4\": 115,\r\n\t\t\t\"f5\": 116,\r\n\t\t\t\"f6\": 117,\r\n\t\t\t\"f7\": 118,\r\n\t\t\t\"f8\": 119,\r\n\t\t\t\"f9\": 120,\r\n\t\t\t\"f10\": 121,\r\n\t\t\t\"f11\": 122,\r\n\t\t\t\"f12\": 123\r\n\t\t}\r\n\t};\r\n};","(function(){\r\n\tvar eventable = require(\"../utils/eventable\");\r\n\tfunction setupKeyNav(gantt){\r\n\t\tgantt.config.keyboard_navigation = true;\r\n\t\tgantt.config.keyboard_navigation_cells = false;\r\n\r\n\t\tgantt.$keyboardNavigation = {};\r\n\r\n\t\tgantt._compose = function(){\r\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\r\n\t\t\tvar res = {};\r\n\t\t\tfor(var i = 0; i < parts.length; i++){\r\n\t\t\t\tvar obj = parts[i];\r\n\t\t\t\tif(typeof obj == \"function\"){\r\n\t\t\t\t\tobj = new obj();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(var p in obj){\r\n\t\t\t\t\tres[p] = obj[p];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t};\r\n\r\n\t\trequire (\"./keyboard_navigation/common/keyboard_shortcuts\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/common/eventhandler\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/common/trap_modal_focus\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/elements/gantt_node\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/elements/nav_node\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/elements/header_cell\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/elements/task_row\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/elements/task_cell\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/modals\")(gantt);\r\n\t\trequire (\"./keyboard_navigation/core\")(gantt);\r\n\r\n\t\tvar domHelpers = require(\"../utils/dom_helpers\");\r\n\r\n\t\t(function(){\r\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\r\n\r\n\t\t\tdispatcher.isTaskFocused = function(id){\r\n\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\r\n\t\t\t\t\tif (node.taskId == id) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tvar keyDownHandler = function(e){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\r\n\t\t\t\treturn dispatcher.keyDownHandler(e);\r\n\t\t\t};\r\n\r\n\t\t\tvar focusHandler = function(e){\r\n\t\t\t\tif(dispatcher.$preventDefault){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tgantt.$container.blur();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdispatcher.focusGlobalNode();\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar reFocusActiveNode = function(){\r\n\t\t\t\tif(!dispatcher.isEnabled())\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\r\n\t\t\t\tif(!activeNode)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar domElement = activeNode.getNode();\r\n\t\t\t\tvar top, left;\r\n\t\t\t\tif(domElement && domElement.parentNode){\r\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\r\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tactiveNode.focus(true);\r\n\r\n\t\t\t\tif(domElement && domElement.parentNode){\r\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\r\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\r\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\t\t\t\treFocusActiveNode();\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\r\n\t\t\t\tgantt.eventRemove(document, \"keydown\", keyDownHandler);\r\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\r\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\r\n\r\n\t\t\t\tif(gantt.config.keyboard_navigation){\r\n\r\n\t\t\t\t\tgantt.event(document, \"keydown\", keyDownHandler);\r\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\r\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\r\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\r\n\r\n\t\t\t\t}else{\r\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfunction getTaskNodeConstructor(){\r\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction mousedownHandler(e){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\r\n\t\t\t\tvar focusNode;\r\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\r\n\t\t\t\tif(locateTask){\r\n\t\t\t\t\t//var node = getTaskNodeConstructor();\r\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\r\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfocusNode = locateTask;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(focusNode) {\r\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\r\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdispatcher.delay(function () {\r\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\r\n\t\t\t\t\tdispatcher.$preventDefault = true;\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\r\n\t\t\t\t// restore focus on repainted tasks\r\n\t\t\t\tgantt.detachEvent(onReady);\r\n\r\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\r\n\t\t\t\t\tvar state = gantt.getState();\r\n\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\r\n\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\r\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\r\n\t\t\t\t\t\t\treFocusActiveNode();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(gantt._smart_render){\r\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawItems;\r\n\t\t\t\t\tgantt._smart_render._redrawItems = function(renderers, items){\r\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\r\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\r\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\r\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\r\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\r\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\r\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\r\n\r\n\t\t\t\t\t\treturn res;\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\r\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\t\t\t\tif(dispatcher.isEnabled()){\r\n\r\n\t\t\t\t\tvar columnIndex = 0;\r\n\t\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\r\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\r\n\r\n\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\r\n\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\r\n\t\t\t\t\tnode.taskId = newId;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t\tfunction getActiveNode(){\r\n\r\n\t\t\t\tvar activeElement = document.activeElement;\r\n\t\t\t\tif(activeElement === document.body && document.getSelection){\r\n\t\t\t\t\tactiveElement = document.getSelection().focusNode || document.body;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn activeElement;\r\n\t\t\t}\r\n\r\n\t\t\tvar interval = setInterval(function(){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\r\n\t\t\t\tvar enable;\r\n\t\t\t\tvar focusElement = getActiveNode();\r\n\r\n\t\t\t\tvar parent = gantt.$container;\r\n\t\t\t\t// halt key nav when focus is outside gantt or in quick info popup\r\n\t\t\t\tif(!focusElement || gantt._locate_css(focusElement, \"gantt_cal_quick_info\")){\r\n\t\t\t\t\tenable = false;\r\n\t\t\t\t}else{\r\n\t\t\t\t\twhile(focusElement != parent &&  focusElement){\r\n\t\t\t\t\t\tfocusElement = focusElement.parentNode;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(focusElement == parent){\r\n\t\t\t\t\t\tenable = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tenable = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(enable && !dispatcher.isEnabled()){\r\n\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t}else if(!enable && dispatcher.isEnabled()){\r\n\t\t\t\t\tdispatcher.disable();\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 500);\r\n\r\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\t\t\tclearInterval(interval);\r\n\t\t\t});\r\n\r\n\t\t\tfunction getScope(mode){\r\n\t\t\t\tvar scopes = {\r\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\r\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\r\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\r\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn scopes[mode] || scopes.gantt;\r\n\t\t\t}\r\n\r\n\t\t\tvar keyNavFacade = {};\r\n\t\t\teventable(keyNavFacade);\r\n\t\t\tgantt.mixin(keyNavFacade, {\r\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\r\n\t\t\t\t\t\tif(commands.length){\r\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(commands[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveShortcut: function(shortcut, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfocus: function(config){\r\n\t\t\t\t\tvar type = config ? config.type : null;\r\n\t\t\t\t\tvar constructor = getScope(type);\r\n\t\t\t\t\tvar node;\r\n\t\t\t\t\tswitch (type){\r\n\t\t\t\t\t\tcase \"taskCell\":\r\n\t\t\t\t\t\t\tnode = new constructor(config.id, gantt.getColumnIndex(config.column));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"taskRow\":\r\n\t\t\t\t\t\t\tnode = new constructor(config.id);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"headerCell\":\r\n\t\t\t\t\t\t\tnode = new constructor(gantt.getColumnIndex(config.column));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdispatcher.delay(function(){\r\n\t\t\t\t\t\tif(node){\r\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\r\n\r\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\r\n\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\r\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\r\n\r\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\r\n\t\t\tgantt.focus = function(){\r\n\t\t\t\tkeyNavFacade.focus();\r\n\t\t\t};\r\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\r\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\r\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\r\n\t\t})();\r\n\r\n\r\n\t}\r\n\r\n\tsetupKeyNav(gantt);\r\n\r\n\r\n\r\n})();","var EventHost = function(){\r\n\tthis._connected = [];\r\n\tthis._silent_mode = false;\r\n};\r\n\r\nEventHost.prototype = {\r\n\t_silentStart: function() {\r\n\t\tthis._silent_mode = true;\r\n\t},\r\n\t_silentEnd: function() {\r\n\t\tthis._silent_mode = false;\r\n\t}\r\n};\r\n\r\nvar\tcreateEventStorage = function(obj) {\r\n\tvar dhx_catch = [];\r\n\tvar z = function(){\r\n\t\tvar res = true;\r\n\t\tfor (var i = 0; i < dhx_catch.length; i++){\r\n\t\t\tif (dhx_catch[i]){\r\n\t\t\t\tvar zr = dhx_catch[i].apply(obj, arguments);\r\n\t\t\t\tres=res&&zr;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\tz.addEvent=function(ev){\r\n\t\tif (typeof (ev) == \"function\")\r\n\t\t\treturn dhx_catch.push(ev)-1;\r\n\t\treturn false;\r\n\t};\r\n\tz.removeEvent=function(id){\r\n\t\tdhx_catch[id]=null;\r\n\t};\r\n\treturn z;\r\n};\r\n\r\nfunction makeEventable(obj){\r\n\r\n\tvar eventHost = new EventHost();\r\n\tobj.attachEvent=function(name, catcher, callObj){\r\n\t\tname='ev_'+name.toLowerCase();\r\n\t\tif (!eventHost[name])\r\n\t\t\teventHost[name] = createEventStorage(callObj||this);\r\n\r\n\t\treturn(name+':'+eventHost[name].addEvent(catcher)); //return ID (event name & event ID)\r\n\t};\r\n\tobj.attachAll = function(callback, callObj){\r\n\t\tthis.attachEvent('listen_all', callback, callObj);\r\n\t};\r\n\r\n\tobj.callEvent=function(name, arg0, callObj){\r\n\t\tif (eventHost._silent_mode) return true;\r\n\r\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\r\n\r\n\t\tif (eventHost['ev_listen_all']){\r\n\t\t\teventHost['ev_listen_all'].apply(callObj || this, [name].concat(arg0));\r\n\t\t}\r\n\r\n\t\tif (eventHost[handlerName])\r\n\t\t\treturn eventHost[handlerName].apply(callObj || this, arg0);\r\n\t\treturn true;\r\n\t};\r\n\tobj.checkEvent=function(name){\r\n\t\treturn (!!eventHost['ev_'+name.toLowerCase()]);\r\n\t};\r\n\tobj.detachEvent=function(id){\r\n\t\tif (id){\r\n\t\t\tvar list = id.split(':');           //get EventName and ID\r\n\t\t\teventHost[list[0]].removeEvent(list[1]); //remove event\r\n\t\t}\r\n\t};\r\n\tobj.detachAllEvents = function(){\r\n\t\tfor (var name in eventHost){\r\n\t\t\tif (name.indexOf(\"ev_\") === 0)\r\n\t\t\t\tdelete eventHost[name];\r\n\t\t}\r\n\t};\r\n\r\n}\r\n\r\nmodule.exports = makeEventable;"],"sourceRoot":""}